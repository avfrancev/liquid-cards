webpackJsonp([1],{AG3r:function(t,i){},"I+T2":function(t,i){},d2c3:function(t,i){},orck:function(t,i,s){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var e,a,r,n=s("7+uW"),o=s("+Uzz");r=function(t,i){return t+Math.floor(Math.random()*(i-t))},e=function(t){var i,s;for(i=0,s=0;t&&!isNaN(t.offsetLeft)&&!isNaN(t.offsetTop);)i+=t.offsetLeft-t.scrollLeft,s+=t.offsetTop-t.scrollTop,t=t.offsetParent;return{top:s,left:i}},a=function(t,i,s,e,a){var r,n,o,h,c,d,l,u,f,p,g,v;for(g=.01*a,v=Math.floor(t.width*g),c=Math.floor(t.height*g),i.drawImage(s,0,0,v,c),i.drawImage(t,0,0,v,c,0,0,v,c),u=(f=i.getImageData(0,0,v,c).data).length/4,o={size:{w:v,h:c},arr:[]},d=0,p=0,0;d<u;)p=f[l=4*d],h=f[++l],n=f[++l],r=f[++l],o.arr.push({r:p,g:h,b:n,a:r}),d++;return o};s("AG3r");var h=Object.assign||function(t){for(var i=1;i<arguments.length;i++){var s=arguments[i];for(var e in s)Object.prototype.hasOwnProperty.call(s,e)&&(t[e]=s[e])}return t},c={functional:!0,render:function(t,i){var s;return s=h({},i.data,{props:{name:"avf-transition",tag:"div"},on:{enter:function(t,i){var s;return t.getAttribute("avf-id"),(s=new o.TimelineMax).from(t,1,{opacity:0}),s.from(t,1,{y:30,ease:o.Elastic.easeOut.config(1,.3),onComplete:i},"-=1")}}}),t("transition-group",s,i.children)}},d=s("mtWM"),l=s.n(d),u={components:{"avf-transition":c},data:function(){return{cards:[],cardsCount:5}},created:function(){return this.fetchCards()},methods:{fetchCards:function(){var t,i,s,e;for(this.loading=!0,e=[],t=i=0,s=this.cardsCount;0<=s?i<s:i>s;t=0<=s?++i:--i)e.push((t=>l.a.get(`https://source.unsplash.com/random?sig=${t}`).then(i=>{var s;return s=new Image,s.src=i.request.responseURL,s.onload=(()=>(t===this.cardsCount-1&&(this.loading=!1),this.cards.push({id:(new Date).getTime(),image_src:i.request.responseURL})))}))(t));return e},addCard:function(t){return t.id=++this.nextCardId,this.cards.push(t)},removeCard:function(t){return t.$card=this.$el.querySelector(`#card-${t.id}`),t.canvas=new class{constructor(t){this.card=t,this.OFFSET=300,this.SPREAD=300,this.$image=new Image,this.$image.crossOrigin="Anonymous",this.$image.onload=this.init.bind(this),this.$image.src=this.card.image_src}init(t){var i,s;return this.c=document.createElement("canvas"),this.ctx=this.c.getContext("2d"),this.$card__image=document.querySelector(`#card-${this.card.id} .card__image`),this.hCanvas=document.createElement("canvas"),this.hCanvas.width=this.$card__image.offsetWidth,this.hCanvas.height=this.$card__image.offsetHeight,s=this.hCanvas.getContext("2d"),i=a(this.hCanvas,s,this.$image,0,10),({w:this.w,h:this.h}=i.size),this.colors=i.arr.map(function(t){return`rgba(${t.r},${t.g},${t.b},${t.a})`}),this.prepareCanvas(),this.card.$card.parentElement.appendChild(this.c)}prepareCanvas(){var t,i,s,a,n,o,h,c,d;for(this.imgPos=this.$card__image.getBoundingClientRect(),this.c.style.position="absolute",this.c.width=this.imgPos.width+2*this.OFFSET,this.c.height=this.imgPos.height+2*this.OFFSET,({left:o,top:this.top}=e(this.$card__image)),this.c.style.top=`${this.top-this.OFFSET}px`,this.c.style.left=`${o-this.OFFSET}px`,this.c.style.display="none",this.circles=[],a=0,this.ctx.clearRect(0,0,this.c.width,this.c.height),i=n=0,c=this.h;0<=c?n<c:n>c;i=0<=c?++n:--n)for(s=h=0,d=this.w;0<=d?h<d:h>d;s=0<=d?++h:--h)this.ctx.fillStyle=this.colors[a],this.ctx.beginPath(),(t={x:s*this.hCanvas.width/this.w+this.OFFSET+this.hCanvas.width/this.w/2,y:i*this.hCanvas.height/this.h+this.OFFSET+this.hCanvas.width/this.w/2,r:this.hCanvas.width/this.w/2*Math.random()*2,progress:0,height:0,alpha:1,dAlpha:.97,color:this.colors[a]}).dx=r(t.x-this.SPREAD,t.x+this.SPREAD),t.dy=r(t.y-this.SPREAD,t.y+this.SPREAD),this.circles.push(t),this.ctx.arc(t.x,t.y,t.r,0,2*Math.PI,!1),this.ctx.fill(),a++;"function"==typeof this.onReady&&this.onReady()}animate(){var t,i,s,e,a,r;for(this.ctx.clearRect(0,0,this.c.width,this.c.height),r=[],i=s=0,e=(a=this.circles).length;s<e;i=++s)t=a[i],this.ctx.globalAlpha=1-t.progress,this.ctx.fillStyle=t.color,this.ctx.beginPath(),this.ctx.arc(t.x,t.y,t.r*(1-t.progress),0,2*Math.PI,!1),r.push(this.ctx.fill());return r}}(t),t.canvas.onReady=this.animateRemove.bind(this,t)},animateRemove:function(t){var i,s;return i=t.$card,{top:0},(s=new o.TimelineMax).set(t.canvas.c,{display:"block"}),s.set(i,{transition:"none"}),s.fromTo(t.canvas.c,1,{opacity:0},{opacity:1}),s.to(i.querySelector(".card__image"),.1,{opacity:0},"-=1"),s.to(i,1,{y:`-=${i.offsetHeight/3}`,scale:"0",opacity:-1,ease:o.Expo.easeInOut,onComplete:()=>(s.set(i,{transition:"10.5s"}),this.cards.splice(this.cards.indexOf(t),1))},"-=1"),s.to(t.canvas.circles,3,{x:i=>t.canvas.circles[i].dx,y:i=>t.canvas.circles[i].dy,progress:1,onUpdate:t.canvas.animate.bind(t.canvas),onComplete:()=>{if(t.canvas.c.remove(),this.cards.length<3)return console.log(this.cardsCount=Math.floor(5-5*Math.random())||2),this.fetchCards()}},"-=1")}}},f={render:function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",{attrs:{id:"explode"}},[s("avf-transition",{style:{display:t.cards.length>0?"grid":"none"},attrs:{id:"cards"}},t._l(t.cards,function(i,e){return s("div",{key:i.id,staticClass:"card",attrs:{id:"card-"+i.id,"avf-id":i.id}},[s("div",{staticClass:"card__inner"},[s("div",{staticClass:"card__image",style:"background-image:url("+i.image_src+")"}),s("h4",[t._v("Card "+t._s(i.id))]),s("button",{on:{click:function(s){t.removeCard(i)}}},[t._v("DEL")])])])})),t.loading||0!=t.cards.length?t._e():s("div",{attrs:{id:"refresh"}},[s("button",{on:{click:t.fetchCards}},[t._v("refresh")])])],1)},staticRenderFns:[]},p={name:"app",components:{Explode:s("VU/8")(u,f,!1,function(t){s("I+T2")},null,null).exports}},g={render:function(){var t=this.$createElement,i=this._self._c||t;return i("div",{attrs:{id:"app"}},[i("Explode"),this._v(" "),i("svg",{attrs:{id:"svg-liquid",xmlns:"http://www.w3.org/2000/svg",version:"1.1"}},[i("defs",[i("filter",{attrs:{id:"liquid"}},[i("feGaussianBlur",{attrs:{in:"SourceGraphic",stdDeviation:"6",result:"blur"}}),this._v(" "),i("feColorMatrix",{attrs:{in:"blur",mode:"matrix",values:"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 50 -10"}})],1)])])],1)},staticRenderFns:[]},v=s("VU/8")(p,g,!1,function(t){s("d2c3")},null,null).exports;n.a.config.productionTip=!1,new n.a({el:"#app",template:"<App/>",components:{App:v}})}},["orck"]);
//# sourceMappingURL=app.07928b62e4da24893ecb.js.map